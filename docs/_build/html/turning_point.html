

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Turning point &mdash; UPOsHam 0.1.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Turning point based on configuration difference" href="turning_point_coord_difference.html" />
    <link rel="prev" title="Differential correction" href="differential_correction.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> UPOsHam
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="doc.html">Unstable Periodic Orbits in Hamiltonian systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.html#id1">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="doc.html#id16">References</a></li>
</ul>
<p class="caption"><span class="caption-text">Methods</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="differential_correction.html">Differential correction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Turning point</a></li>
<li class="toctree-l1"><a class="reference internal" href="turning_point_coord_difference.html">Turning point based on configuration difference</a></li>
</ul>
<p class="caption"><span class="caption-text">Examples</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="deleonberne_ham.html">De Leon-Berne Hamiltonian</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartic_ham.html">Coupled quartic Hamiltonian</a></li>
<li class="toctree-l1"><a class="reference internal" href="quartic_ham.html#module-uncoupled_quartic_hamiltonian">Uncoupled quartic Hamiltonian</a></li>
</ul>
<p class="caption"><span class="caption-text">Contributing and reporting</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing to UPOsHam</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html#id1">Code of Conduct</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html#id2">What should I know before I get started?</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html#id3">How Can I Contribute?</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">UPOsHam</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Turning point</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/turning_point.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="turning-point">
<h1>Turning point<a class="headerlink" href="#turning-point" title="Permalink to this headline">¶</a></h1>
<p>This method is based on finding the unstable periodic orbit by detecting trajectories initialized on the equipotential contour (<span class="math notranslate nohighlight">\(V(x,y) = E\)</span> where <span class="math notranslate nohighlight">\(V(x,y)\)</span> is the potetial energy function and <span class="math notranslate nohighlight">\(E\)</span> is the total energy) that turn in the opposite directions. This method relies on the fact that for Hamiltonians of the form kinetic plus potential energy the unstable periodic orbit is the limiting trajectory that bounces back and forth between the equipotential contour corresponding to the given total energy. So to converge on this limiting trajectory, the turning point method iteratively decreases the gap between the bounding trajectories that turn in the opposite directions. Detection of turning is done using a dot product condition which leads to stalling of the method beyond a certain tolerance (typically <span class="math notranslate nohighlight">\(10^{-6}\)</span> in the examples here.)</p>
<blockquote>
<div><span class="target" id="module-turning_point"></span><p>Created on Thu Sep 12 17:34:06 2019</p>
<p>&#64;author: Wenyang Lyu and Shibabrat Naik</p>
<dl class="function">
<dt id="turning_point.dotproduct">
<code class="sig-prename descclassname">turning_point.</code><code class="sig-name descname">dotproduct</code><span class="sig-paren">(</span><em class="sig-param">guess1</em>, <em class="sig-param">guess2</em>, <em class="sig-param">n_turn</em>, <em class="sig-param">ham2dof_model</em>, <em class="sig-param">half_period_model</em>, <em class="sig-param">varEqns_model</em>, <em class="sig-param">par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/turning_point.html#dotproduct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#turning_point.dotproduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns x,y coordinates of the turning points for guess initial conditions guess1, guess2 and the defined product product for the 2 turning points</p>
<p>Uses turning point method(defined a dot product form before the “actual” turning point.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>guess1</strong> (<em>1d numpy array</em>) – guess initial condition 1 for the unstable periodic orbit</p></li>
<li><p><strong>guess2</strong> (<em>1d numpy array</em>) – guess initial condition 2 for the unstable periodic orbit</p></li>
<li><p><strong>n_turn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – nth turning point that is used to define the dot product</p></li>
<li><p><strong>ham2dof_model</strong> (<em>function name</em>) – function that returns the Hamiltonian vector field at an input phase space coordinate
and time</p></li>
<li><p><strong>variational_eqns_model</strong> (<em>function name</em>) – function that returns the variational equations of the dynamical system</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – model parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_turn1</strong> (<em>float</em>) – x coordinate of the turning point with initional condition guess1</p></li>
<li><p><strong>x_turn2</strong> (<em>float</em>) – x coordinate of the turning point with initional condition guess2</p></li>
<li><p><strong>y_turn1</strong> (<em>float</em>) – y coordinate of the turning point with initional condition guess1</p></li>
<li><p><strong>y_turn2</strong> (<em>float</em>) – y coordinate of the turning point with initional condition guess2</p></li>
<li><p><strong>dotproduct</strong> (<em>float</em>) – value of the dot product</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="turning_point.get_eq_pts">
<code class="sig-prename descclassname">turning_point.</code><code class="sig-name descname">get_eq_pts</code><span class="sig-paren">(</span><em class="sig-param">eqNum</em>, <em class="sig-param">init_guess_eqpt_model</em>, <em class="sig-param">grad_pot_model</em>, <em class="sig-param">par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/turning_point.html#get_eq_pts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#turning_point.get_eq_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns configuration space coordinates of the equilibrium points.</p>
<p>get_eq_pts(eqNum, init_guess_eqpt_model, grad_pot_model, par) solves the
coordinates of the equilibrium point for a Hamiltonian of the form kinetic
energy (KE) + potential energy (PE).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>eqNum</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – 1 is the saddle-center equilibrium point
2 or 3 is the center-center equilibrium point</p></li>
<li><p><strong>init_guess_eqpt_model</strong> (<em>function name</em>) – function that returns the initial guess for the equilibrium point</p></li>
<li><p><strong>grad_pot_model</strong> (<em>function name</em>) – function that defines the vector of potential gradient</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – model parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>configuration space coordinates</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)">float</a> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)">list</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="turning_point.get_pot_surf_proj">
<code class="sig-prename descclassname">turning_point.</code><code class="sig-name descname">get_pot_surf_proj</code><span class="sig-paren">(</span><em class="sig-param">xVec</em>, <em class="sig-param">yVec</em>, <em class="sig-param">pot_energy_model</em>, <em class="sig-param">par</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/turning_point.html#get_pot_surf_proj"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#turning_point.get_pot_surf_proj" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns projection of the potential energy (PE) surface on the configuration space</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>yVec</strong> (<em>xVec</em><em>,</em>) – x,y-coordinates that discretizes the x, y domain of the configuration space</p></li>
<li><p><strong>pot_energy_model</strong> (<em>function name</em>) – function that returns the potential energy of Hamiltonian</p></li>
<li><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – model parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>values of the PE</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>2d numpy array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="turning_point.get_total_energy">
<code class="sig-prename descclassname">turning_point.</code><code class="sig-name descname">get_total_energy</code><span class="sig-paren">(</span><em class="sig-param">orbit</em>, <em class="sig-param">pot_energy_model</em>, <em class="sig-param">parameters</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/turning_point.html#get_total_energy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#turning_point.get_total_energy" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total energy (value of Hamiltonian) of a phase space point on an orbit</p>
<p>get_total_energy(orbit, pot_energy_model, parameters) returns the total energy for a
Hamiltonian of the form KE + PE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>orbit</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – phase space coordinates (x,y,px,py) of a point on an orbit</p></li>
<li><p><strong>pot_energy_model</strong> (<em>function name</em>) – function that returns the potential energy of Hamiltonian</p></li>
<li><p><strong>parameters</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – model parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>total energy (value of Hamiltonian)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>scalar</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="turning_point.state_transit_matrix">
<code class="sig-prename descclassname">turning_point.</code><code class="sig-name descname">state_transit_matrix</code><span class="sig-paren">(</span><em class="sig-param">tf</em>, <em class="sig-param">x0</em>, <em class="sig-param">par</em>, <em class="sig-param">variational_eqns_model</em>, <em class="sig-param">fixed_step=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/turning_point.html#state_transit_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#turning_point.state_transit_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns state transition matrix, the trajectory, and the solution of the
variational equations over a length of time</p>
<p>In particular, for periodic solutions of % period tf=T, one can obtain
the monodromy matrix, PHI(0,T).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tf</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – final time for the integration</p></li>
<li><p><strong>x0</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – initial condition</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – model parameters</p></li>
<li><p><strong>variational_eqns_model</strong> (<em>function name</em>) – function that returns the variational equations of the dynamical system</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>t</strong> (<em>1d numpy array</em>) – solution time</p></li>
<li><p><strong>x</strong> (<em>2d numpy array</em>) – solution of the phase space coordinates</p></li>
<li><p><strong>phi_tf</strong> (<em>2d numpy array</em>) – state transition matrix at the final time, tf</p></li>
<li><p><strong>PHI</strong> (<em>1d numpy array,</em>) – solution of phase space coordinates and corresponding tangent space coordinates</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="turning_point.turningPoint">
<code class="sig-prename descclassname">turning_point.</code><code class="sig-name descname">turningPoint</code><span class="sig-paren">(</span><em class="sig-param">begin1</em>, <em class="sig-param">begin2</em>, <em class="sig-param">get_coord_model</em>, <em class="sig-param">guess_coords_model</em>, <em class="sig-param">ham2dof_model</em>, <em class="sig-param">half_period_model</em>, <em class="sig-param">variational_eqns_model</em>, <em class="sig-param">pot_energy_model</em>, <em class="sig-param">plot_iter_orbit_model</em>, <em class="sig-param">par</em>, <em class="sig-param">e</em>, <em class="sig-param">n</em>, <em class="sig-param">n_turn</em>, <em class="sig-param">show_itrsteps_plots</em>, <em class="sig-param">po_fam_file</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/turning_point.html#turningPoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#turning_point.turningPoint" title="Permalink to this definition">¶</a></dt>
<dd><p>turningPoint computes the periodic orbit of target energy using turning point method.</p>
<p>Given 2 inital conditions begin1, begin2, the periodic orbit is assumed to exist between begin1, begin2 such that
trajectories with inital conditions begin1, begin2 are turning in different directions,
which results in a negative value of the dot product</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>begin1</strong> (<em>function name</em>) – guess initial condition 1 for the unstable periodic orbit</p></li>
<li><p><strong>begin2</strong> (<em>function name</em>) – guess initial condition 2 for the unstable periodic orbit</p></li>
<li><p><strong>get_coord_model</strong> (<em>function name</em>) – function that returns the phase space coordinate for a given x/y value and total energy E</p></li>
<li><p><strong>guess_coord_model</strong> (<em>function name</em>) – function that returns the coordinates as guess for the next iteration of the</p></li>
<li><p><strong>point</strong> (<em>turning</em>) – </p></li>
<li><p><strong>ham2dof_model</strong> (<em>function name</em>) – function that returns the Hamiltonian vector field at an input phase space coordinate
and time</p></li>
<li><p><strong>half_period_model</strong> (<em>function name</em>) – function that returns the event criteria in terms of the coordinate that is set to zero
for half-period of the unstable periodic orbit</p></li>
<li><p><strong>pot_energy_model</strong> (<em>function name</em>) – function that returns the potential energy of Hamiltonian</p></li>
<li><p><strong>variational_eqns_model</strong> (<em>function name</em>) – function that returns the variational equations of the dynamical system</p></li>
<li><p><strong>plot_iter_orbit_model</strong> (<em>function name</em>) – function to plot the computed orbit in the 3D phase space of 2 position and 1 momentum
coordinate</p></li>
<li><p><strong>par</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em> (</em><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>)</em>) – model parameters</p></li>
<li><p><strong>e</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – total energy of the system</p></li>
<li><p><strong>n</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – number of intervals that is divided bewteen the 2 initial guesses begin1 and begin2</p></li>
<li><p><strong>n_turn</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – nth turning point that is used to define the dot product</p></li>
<li><p><strong>show_itrsteps_plots</strong> (<em>logical</em>) – flag (True or False) to show iteration of the UPOs in plots</p></li>
<li><p><strong>po_fam_file</strong> (<em>function name</em>) – file name to save the members in the family of the unstable periodic orbits</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x0po</strong> (<em>1d numpy array</em>) – Initial condition of the target unstable periodic orbit</p></li>
<li><p><strong>T</strong> (<em>float</em>) – Time period of the target unstable periodic orbit</p></li>
<li><p><strong>energyPO</strong> (<em>float</em>) – Energy of the target unstable periodic orbit.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div></blockquote>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="turning_point_coord_difference.html" class="btn btn-neutral float-right" title="Turning point based on configuration difference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="differential_correction.html" class="btn btn-neutral float-left" title="Differential correction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Wenyang Lyu, Shibabrat Naik, Stephen Wiggins

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>